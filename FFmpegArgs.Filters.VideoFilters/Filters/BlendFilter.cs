/*
 blend AVOptions:
   c0_mode           <int>        ..FV.....T. set component #0 blend mode (from 0 to 39) (default normal)
     addition        1            ..FV.....T. 
     addition128     28           ..FV.....T. 
     grainmerge      28           ..FV.....T. 
     and             2            ..FV.....T. 
     average         3            ..FV.....T. 
     burn            4            ..FV.....T. 
     darken          5            ..FV.....T. 
     difference      6            ..FV.....T. 
     difference128   7            ..FV.....T. 
     grainextract    7            ..FV.....T. 
     divide          8            ..FV.....T. 
     dodge           9            ..FV.....T. 
     exclusion       10           ..FV.....T. 
     extremity       32           ..FV.....T. 
     freeze          31           ..FV.....T. 
     glow            27           ..FV.....T. 
     hardlight       11           ..FV.....T. 
     hardmix         25           ..FV.....T. 
     heat            30           ..FV.....T. 
     lighten         12           ..FV.....T. 
     linearlight     26           ..FV.....T. 
     multiply        13           ..FV.....T. 
     multiply128     29           ..FV.....T. 
     negation        14           ..FV.....T. 
     normal          0            ..FV.....T. 
     or              15           ..FV.....T. 
     overlay         16           ..FV.....T. 
     phoenix         17           ..FV.....T. 
     pinlight        18           ..FV.....T. 
     reflect         19           ..FV.....T. 
     screen          20           ..FV.....T. 
     softlight       21           ..FV.....T. 
     subtract        22           ..FV.....T. 
     vividlight      23           ..FV.....T. 
     xor             24           ..FV.....T. 
     softdifference  33           ..FV.....T. 
     geometric       34           ..FV.....T. 
     harmonic        35           ..FV.....T. 
     bleach          36           ..FV.....T. 
     stain           37           ..FV.....T. 
     interpolate     38           ..FV.....T. 
     hardoverlay     39           ..FV.....T. 
   c1_mode           <int>        ..FV.....T. set component #1 blend mode (from 0 to 39) (default normal)
     addition        1            ..FV.....T. 
     addition128     28           ..FV.....T. 
     grainmerge      28           ..FV.....T. 
     and             2            ..FV.....T. 
     average         3            ..FV.....T. 
     burn            4            ..FV.....T. 
     darken          5            ..FV.....T. 
     difference      6            ..FV.....T. 
     difference128   7            ..FV.....T. 
     grainextract    7            ..FV.....T. 
     divide          8            ..FV.....T. 
     dodge           9            ..FV.....T. 
     exclusion       10           ..FV.....T. 
     extremity       32           ..FV.....T. 
     freeze          31           ..FV.....T. 
     glow            27           ..FV.....T. 
     hardlight       11           ..FV.....T. 
     hardmix         25           ..FV.....T. 
     heat            30           ..FV.....T. 
     lighten         12           ..FV.....T. 
     linearlight     26           ..FV.....T. 
     multiply        13           ..FV.....T. 
     multiply128     29           ..FV.....T. 
     negation        14           ..FV.....T. 
     normal          0            ..FV.....T. 
     or              15           ..FV.....T. 
     overlay         16           ..FV.....T. 
     phoenix         17           ..FV.....T. 
     pinlight        18           ..FV.....T. 
     reflect         19           ..FV.....T. 
     screen          20           ..FV.....T. 
     softlight       21           ..FV.....T. 
     subtract        22           ..FV.....T. 
     vividlight      23           ..FV.....T. 
     xor             24           ..FV.....T. 
     softdifference  33           ..FV.....T. 
     geometric       34           ..FV.....T. 
     harmonic        35           ..FV.....T. 
     bleach          36           ..FV.....T. 
     stain           37           ..FV.....T. 
     interpolate     38           ..FV.....T. 
     hardoverlay     39           ..FV.....T. 
   c2_mode           <int>        ..FV.....T. set component #2 blend mode (from 0 to 39) (default normal)
     addition        1            ..FV.....T. 
     addition128     28           ..FV.....T. 
     grainmerge      28           ..FV.....T. 
     and             2            ..FV.....T. 
     average         3            ..FV.....T. 
     burn            4            ..FV.....T. 
     darken          5            ..FV.....T. 
     difference      6            ..FV.....T. 
     difference128   7            ..FV.....T. 
     grainextract    7            ..FV.....T. 
     divide          8            ..FV.....T. 
     dodge           9            ..FV.....T. 
     exclusion       10           ..FV.....T. 
     extremity       32           ..FV.....T. 
     freeze          31           ..FV.....T. 
     glow            27           ..FV.....T. 
     hardlight       11           ..FV.....T. 
     hardmix         25           ..FV.....T. 
     heat            30           ..FV.....T. 
     lighten         12           ..FV.....T. 
     linearlight     26           ..FV.....T. 
     multiply        13           ..FV.....T. 
     multiply128     29           ..FV.....T. 
     negation        14           ..FV.....T. 
     normal          0            ..FV.....T. 
     or              15           ..FV.....T. 
     overlay         16           ..FV.....T. 
     phoenix         17           ..FV.....T. 
     pinlight        18           ..FV.....T. 
     reflect         19           ..FV.....T. 
     screen          20           ..FV.....T. 
     softlight       21           ..FV.....T. 
     subtract        22           ..FV.....T. 
     vividlight      23           ..FV.....T. 
     xor             24           ..FV.....T. 
     softdifference  33           ..FV.....T. 
     geometric       34           ..FV.....T. 
     harmonic        35           ..FV.....T. 
     bleach          36           ..FV.....T. 
     stain           37           ..FV.....T. 
     interpolate     38           ..FV.....T. 
     hardoverlay     39           ..FV.....T. 
   c3_mode           <int>        ..FV.....T. set component #3 blend mode (from 0 to 39) (default normal)
     addition        1            ..FV.....T. 
     addition128     28           ..FV.....T. 
     grainmerge      28           ..FV.....T. 
     and             2            ..FV.....T. 
     average         3            ..FV.....T. 
     burn            4            ..FV.....T. 
     darken          5            ..FV.....T. 
     difference      6            ..FV.....T. 
     difference128   7            ..FV.....T. 
     grainextract    7            ..FV.....T. 
     divide          8            ..FV.....T. 
     dodge           9            ..FV.....T. 
     exclusion       10           ..FV.....T. 
     extremity       32           ..FV.....T. 
     freeze          31           ..FV.....T. 
     glow            27           ..FV.....T. 
     hardlight       11           ..FV.....T. 
     hardmix         25           ..FV.....T. 
     heat            30           ..FV.....T. 
     lighten         12           ..FV.....T. 
     linearlight     26           ..FV.....T. 
     multiply        13           ..FV.....T. 
     multiply128     29           ..FV.....T. 
     negation        14           ..FV.....T. 
     normal          0            ..FV.....T. 
     or              15           ..FV.....T. 
     overlay         16           ..FV.....T. 
     phoenix         17           ..FV.....T. 
     pinlight        18           ..FV.....T. 
     reflect         19           ..FV.....T. 
     screen          20           ..FV.....T. 
     softlight       21           ..FV.....T. 
     subtract        22           ..FV.....T. 
     vividlight      23           ..FV.....T. 
     xor             24           ..FV.....T. 
     softdifference  33           ..FV.....T. 
     geometric       34           ..FV.....T. 
     harmonic        35           ..FV.....T. 
     bleach          36           ..FV.....T. 
     stain           37           ..FV.....T. 
     interpolate     38           ..FV.....T. 
     hardoverlay     39           ..FV.....T. 
   all_mode          <int>        ..FV.....T. set blend mode for all components (from -1 to 39) (default -1)
     addition        1            ..FV.....T. 
     addition128     28           ..FV.....T. 
     grainmerge      28           ..FV.....T. 
     and             2            ..FV.....T. 
     average         3            ..FV.....T. 
     burn            4            ..FV.....T. 
     darken          5            ..FV.....T. 
     difference      6            ..FV.....T. 
     difference128   7            ..FV.....T. 
     grainextract    7            ..FV.....T. 
     divide          8            ..FV.....T. 
     dodge           9            ..FV.....T. 
     exclusion       10           ..FV.....T. 
     extremity       32           ..FV.....T. 
     freeze          31           ..FV.....T. 
     glow            27           ..FV.....T. 
     hardlight       11           ..FV.....T. 
     hardmix         25           ..FV.....T. 
     heat            30           ..FV.....T. 
     lighten         12           ..FV.....T. 
     linearlight     26           ..FV.....T. 
     multiply        13           ..FV.....T. 
     multiply128     29           ..FV.....T. 
     negation        14           ..FV.....T. 
     normal          0            ..FV.....T. 
     or              15           ..FV.....T. 
     overlay         16           ..FV.....T. 
     phoenix         17           ..FV.....T. 
     pinlight        18           ..FV.....T. 
     reflect         19           ..FV.....T. 
     screen          20           ..FV.....T. 
     softlight       21           ..FV.....T. 
     subtract        22           ..FV.....T. 
     vividlight      23           ..FV.....T. 
     xor             24           ..FV.....T. 
     softdifference  33           ..FV.....T. 
     geometric       34           ..FV.....T. 
     harmonic        35           ..FV.....T. 
     bleach          36           ..FV.....T. 
     stain           37           ..FV.....T. 
     interpolate     38           ..FV.....T. 
     hardoverlay     39           ..FV.....T. 
   c0_expr           <string>     ..FV.....T. set color component #0 expression
   c1_expr           <string>     ..FV.....T. set color component #1 expression
   c2_expr           <string>     ..FV.....T. set color component #2 expression
   c3_expr           <string>     ..FV.....T. set color component #3 expression
   all_expr          <string>     ..FV.....T. set expression for all color components
   c0_opacity        <double>     ..FV.....T. set color component #0 opacity (from 0 to 1) (default 1)
   c1_opacity        <double>     ..FV.....T. set color component #1 opacity (from 0 to 1) (default 1)
   c2_opacity        <double>     ..FV.....T. set color component #2 opacity (from 0 to 1) (default 1)
   c3_opacity        <double>     ..FV.....T. set color component #3 opacity (from 0 to 1) (default 1)
   all_opacity       <double>     ..FV.....T. set opacity for all color components (from 0 to 1) (default 1)
 */
namespace FFmpegArgs.Filters.VideoFilters
{
    /// <summary>
    /// TS. blend             VV->V      Blend two video frames into each other.<br></br>
    /// https://ffmpeg.org/ffmpeg-filters.html#blend-1
    /// </summary>
    public class BlendFilter : ImageToImageFilter, ITimelineSupport, ISliceThreading, IFramesync
    {
        static readonly IEnumerable<string> _variables = new List<string>()
        {
            "N",
            "X", "Y",
            "W", "H",
            "SW", "SH",
            "T",
            "TOP", "A",
            "BOTTOM", "B"
        };
        readonly FFmpegExpression expression = new FFmpegExpression(_variables);
        internal BlendFilter(ImageMap top, ImageMap bottom) : base("blend", top, bottom)
        {
            AddMapOut();
        }
        /// <summary>
        /// Set blend mode for specific pixel component or all pixel components in case of all_mode. Default value is normal.
        /// </summary>
        /// <param name="blendMode"></param>
        /// <returns></returns>
        public BlendFilter C0_Mode(BlendMode blendMode)
          => this.SetOption("c0_mode", blendMode);
        /// <summary>
        /// Set blend mode for specific pixel component or all pixel components in case of all_mode. Default value is normal.
        /// </summary>
        /// <param name="blendMode"></param>
        /// <returns></returns>
        public BlendFilter C1_Mode(BlendMode blendMode)
          => this.SetOption("c1_mode", blendMode);
        /// <summary>
        /// Set blend mode for specific pixel component or all pixel components in case of all_mode. Default value is normal.
        /// </summary>
        /// <param name="blendMode"></param>
        /// <returns></returns>
        public BlendFilter C2_Mode(BlendMode blendMode)
          => this.SetOption("c2_mode", blendMode);
        /// <summary>
        /// Set blend mode for specific pixel component or all pixel components in case of all_mode. Default value is normal.
        /// </summary>
        /// <param name="blendMode"></param>
        /// <returns></returns>
        public BlendFilter C3_Mode(BlendMode blendMode)
          => this.SetOption("c3_mode", blendMode);
        /// <summary>
        /// Set blend mode for specific pixel component or all pixel components in case of all_mode. Default value is normal.
        /// </summary>
        /// <param name="blendMode"></param>
        /// <returns></returns>
        public BlendFilter All_Mode(BlendMode blendMode)
          => this.SetOption("all_mode", blendMode);
        /// <summary>
        /// Set blend opacity for specific pixel component or all pixel components in case of all_opacity. Only used in combination with pixel component blend modes.
        /// </summary>
        /// <param name="opacity"></param>
        /// <returns></returns>
        public BlendFilter C0_Opacity(double opacity)
          => this.SetOptionRange("c0_opacity", opacity, 0, 1);
        /// <summary>
        /// Set blend opacity for specific pixel component or all pixel components in case of all_opacity. Only used in combination with pixel component blend modes.
        /// <br></br>(from 0 to 1) (default 1)
        /// </summary>
        /// <param name="opacity"></param>
        /// <returns></returns>
        public BlendFilter C1_Opacity(double opacity)
          => this.SetOptionRange("c1_opacity", opacity, 0, 1);
        /// <summary>
        /// Set blend opacity for specific pixel component or all pixel components in case of all_opacity. Only used in combination with pixel component blend modes.
        /// <br></br>(from 0 to 1) (default 1)
        /// </summary>
        /// <param name="opacity"></param>
        /// <returns></returns>
        public BlendFilter C2_Opacity(double opacity)
          => this.SetOptionRange("c2_opacity", opacity, 0, 1);
        /// <summary>
        /// Set blend opacity for specific pixel component or all pixel components in case of all_opacity. Only used in combination with pixel component blend modes.
        /// <br></br>(from 0 to 1) (default 1)
        /// </summary>
        /// <param name="opacity"></param>
        /// <returns></returns>
        public BlendFilter C3_Opacity(double opacity)
          => this.SetOptionRange("c3_opacity", opacity, 0, 1);
        /// <summary>
        /// Set blend opacity for specific pixel component or all pixel components in case of all_opacity. Only used in combination with pixel component blend modes.
        /// <br></br>(from 0 to 1) (default 1)
        /// </summary>
        /// <param name="opacity"></param>
        /// <returns></returns>
        public BlendFilter All_Opacity(double opacity)
          => this.SetOptionRange("all_opacity", opacity, 0, 1);
        /// <summary>
        /// Set blend expression for specific pixel component or all pixel components in case of all_expr. Note that related mode options will be ignored if those are set.
        /// </summary>
        /// <param name="expr"></param>
        /// <returns></returns>
        public BlendFilter C0_Expr(ExpressionValue expr)
          => this.SetOption("c0_expr", expression.Check(expr));
        /// <summary>
        /// Set blend expression for specific pixel component or all pixel components in case of all_expr. Note that related mode options will be ignored if those are set.
        /// </summary>
        /// <param name="expr"></param>
        /// <returns></returns>
        public BlendFilter C1_Expr(ExpressionValue expr)
          => this.SetOption("c1_expr", expression.Check(expr));
        /// <summary>
        /// Set blend expression for specific pixel component or all pixel components in case of all_expr. Note that related mode options will be ignored if those are set.
        /// </summary>
        /// <param name="expr"></param>
        /// <returns></returns>
        public BlendFilter C2_Expr(ExpressionValue expr)
          => this.SetOption("c2_expr", expression.Check(expr));
        /// <summary>
        /// Set blend expression for specific pixel component or all pixel components in case of all_expr. Note that related mode options will be ignored if those are set.
        /// </summary>
        /// <param name="expr"></param>
        /// <returns></returns>
        public BlendFilter C3_Expr(ExpressionValue expr)
          => this.SetOption("c3_expr", expression.Check(expr));
        /// <summary>
        /// Set blend expression for specific pixel component or all pixel components in case of all_expr. Note that related mode options will be ignored if those are set.
        /// </summary>
        /// <param name="expr"></param>
        /// <returns></returns>
        public BlendFilter All_Expr(ExpressionValue expr)
          => this.SetOption("all_expr", expression.Check(expr));
    }
    /// <summary>
    /// 
    /// </summary>
    public static class BlendFilterExtension
    {
        /// <summary>
        /// Blend two video frames into each other.<br></br>
        /// The blend filter takes two input streams and outputs one stream, the first input is the "top" layer and second input is "bottom" layer.By default, the output terminates when the longest input terminates.<br></br>
        /// The tblend (time blend) filter takes two consecutive frames from one single stream, and outputs the result obtained by blending the new frame on top of the old frame.
        /// </summary>
        /// <param name="top"></param>
        /// <param name="bottom"></param>
        /// <returns></returns>
        public static BlendFilter BlendFilterOn(this ImageMap top, ImageMap bottom)
        {
            return new BlendFilter(top, bottom);
        }
    }
    public enum BlendMode
    {
        addition,
        and,
        average,
        bleach,
        burn,
        darken,
        difference,
        divide,
        dodge,
        exclusion,
        extremity,
        freeze,
        geometric,
        glow,
        grainextract,
        grainmerge,
        hardlight,
        hardmix,
        hardoverlay,
        harmonic,
        heat,
        interpolate,
        lighten,
        linearlight,
        multiply,
        multiply128,
        negation,
        normal,
        or,
        overlay,
        phoenix,
        pinlight,
        reflect,
        screen,
        softdifference,
        softlight,
        stain,
        subtract,
        vividlight,
        xor
    }
}
